<!DOCTYPE html>
<html>
<head>
    <title>HVSA</title>
    <link href='https://fonts.googleapis.com/css?family=Press Start 2P' rel='stylesheet'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/index.css') }}">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="icon" href="/static/img/icon.png" type="image/x-icon"/>
</head>
<body>
    <header>
        <a href="{{ url_for('index') }}">
            <img src="/static/img/icon.png" alt="Icon" class="icon">
            <h1>HVSA</h1>
        </a>
        <nav>
            <ul>
                <li><a href="{{ url_for('index') }}">Home</a></li>
                <li><a href="https://github.com/Jimuell12/Flask-Text-Detection">Resources</a></li>
                <li><a href="https://huggingface.co/rimuruu1/TextDetection">Documentation</a></li>
            </ul>
        </nav>
    </header>
    <div class="card-container">
        <div class="card" id="input">
            <h2 style="font-weight: normal;font-size: 14px;">Is this content authored by a <span class="person-weight">Human</span> or <span class="ai-weight">AI</span>?</h2>
            <p class="subtitle">Analyze text and predict its origin</p>
            <form action="/predict_text" id="text-form" method="post" enctype="multipart/form-data">
                <textarea id="text-input" name="text-input" rows="4" cols="50" placeholder="Enter text..."></textarea><br>
                <input type="submit" id="text-predict-button" value="Predict Text" onclick="submittext()">
            </form>
        <form action="/upload" id="upload-form" method="post" enctype="multipart/form-data">
            <label for="file" class="custom-file-button">
                Upload File
            </label>
            <input type="file" id="file" name="file" accept=".txt,.docx,.pdf,.png,.jpg" capture onchange="submitForm()" />
            <input type="submit" id="predict-button" value="Predict" hidden>
            <p>.pdf, .docx, .txt, .png, .jpg</p>
        </form>            
        </div>

        
        <div class="card" id="result">

            
            {% if avg_ai_probability is defined and avg_human_probability is defined %}
            <div class="resultpercentage">
                <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" data-ai-probability="{{ avg_ai_probability }}">0%</div>
                <div class="resultpercentage-sub">
                    <span class="probability-text">
                        {% if avg_ai_probability > 0.80 %}
                            This text is very likely to be generated by AI.
                        {% elif avg_ai_probability > 0.70 %}
                            This text appears to be highly likely to be written by AI.
                        {% elif avg_ai_probability > 0.60 %}
                            This text shows strong indications of being generated by AI.
                        {% elif avg_ai_probability > 0.50 %}
                            This text has moderate indications of being generated by AI.
                        {% elif avg_ai_probability > 0.40 %}
                            This text is somewhat likely to be generated by AI.
                        {% else %}
                            This text is more likely to be written by a human.
                        {% endif %}
                    </span>
                    <span class="probability-text-sub">
                        {% set rounded_probability = (avg_ai_probability * 100) | round(0) | int %}
                        {% if rounded_probability > 50 %}
                            There is a {{ rounded_probability }}% probability this text was written by AI.
                        {% else %}
                            There is a {{ 100 - rounded_probability }}% probability this text was written by Human.
                        {% endif %}
                    </span> 
                </div>               
            </div>
            <hr>
            <div id="result-summary">Sentences are color-coded: green signifies text closest to human-written content, while red indicates text generated by AI.</div>
            {% endif %}

            {% if predictions %}
                <div id="detailed-predictions">
                    <div id="highlighted-text">
                        {% for prediction in predictions %}
                        <span class="{% if prediction.ai_probability < 0.5 %}highlight-low{% elif prediction.ai_probability < 0.9 %}highlight-medium{% else %}highlight-high{% endif %}">
                            {{ prediction.text | replace("\n", "<br>") | safe }}
                        </span>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}

            <label id="print"><u>Report</u></label>

        </div>
    </div>

    <div id="overlay">
        <div id="report-content">
            <!-- Add your report content here -->
            <h2>Performance</h2>
            <div class="Performance">
                {% if avg_ai_probability %}
                <p>The text score, which is currently set at {{(avg_human_probability * 100) | round(0) | int}} out of 100, serves as a representative measure of the content's human origin. This score can be adjusted as needed to reflect the degree of human involvement in creating the text for your print report."</p>
                <div class="performancescore">{{(avg_human_probability * 100) | round(0) | int}}</div>
                {% endif %}
            </div>
            <h2>Detailed Report</h2>
            <div class="detailed">
                {% if predictions %}
                    {% for prediction in predictions %}
                        <div class="ai">
                            <label class="cell" for="ai-progress">AI</label>
                            <label class="cell" id="aiscore">{{(prediction.ai_probability * 100) | round(0) | int}}</label>
                            <progress  class="cell" id="ai-progress" max="1" value="{{ prediction.ai_probability }}"></progress><br>
                        </div>
                        <div class="human">
                            <label class="cell" for="human-progress">Human</label>
                            <label  class="cell" id="humanscore">{{(prediction.human_probability * 100) | round(0) | int}}</label>
                            <progress class="cell" id="human-progress" max="1" value="{{ prediction.human_probability }}"></progress><br><br>
                        </div> 
                        <span class="{% if prediction.ai_probability < 0.5 %}highlight-low{% elif prediction.ai_probability < 0.9 %}highlight-medium{% else %}highlight-high{% endif %}">
                            {{ prediction.text | replace("\n", "<br>") | safe }}
                        </span>
                    {% endfor %}
                    <br>
                    <br>
                {% endif %}
            </div>

            
            <div class="buttons">
                <button onclick="closeOverlay()" class="close">Close</button>
                <label onclick="printReport()"><i class='bx bx-download'></i>DOWNLOAD PDF REPORT</label>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer">
            <a href="{{ url_for('privacy_policy') }}">Privacy Policy</a>
            <a href="{{ url_for('terms_of_service') }}">Terms of Service</a>
            <a href="https://www.facebook.com/flojerajimuel/">Contact Us</a>
        </div>
        <hr>
        <div class="sub-footer">
            <img src="/static/img/icon.png" alt="icon" style="height: 25px;width: 25px;">
            <p>HVSA, 2023.</p>
        </div>
    </footer>

    {% if error %}
    <div id="error-overlay" class="overlay">
        <div id="error-content">
            <h2>Error</h2>
            <p id="error-message">{{error}}</p>
            <button onclick="closeErrorOverlay()">Close</button>
        </div>
    </div>
    {% endif %}
    

    <div class="pixel-spinner" hidden>
        <div class="pixel"></div>
        <div class="pixel"></div>
        <div class="pixel"></div>
        <div class="pixel"></div>
    </div>
      
    <script src="{{ url_for('static', filename='js/script.js') }}">
    </script>
</body>
</html>
